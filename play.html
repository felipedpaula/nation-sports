<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pantera Sports</title>
    <link rel="stylesheet" href="estilos/styles.css">
    <link rel="shortcut icon" type="image/x-icon" href="favicon.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Raleway:ital,wght@0,300;0,400;0,500;0,700;1,300;1,400;1,500;1,700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="center">
        <div class="topo-app card">
            <img width="60" height="60" src="logo-original.png" alt="">
            <h1>Pantera Sports</h1>
        </div>

        <div class="corpo card">
           <div class="area-jogo">
               <div class="topo-jogo">
                    <div class="status-jogo">
                        <label class="label-app">| Status JOGO:</label>
                        <div class="sinal parado">
                            Pausado
                        </div>
                    </div>
                    <div class="tempo-jogo">
                        <label class="label-app">| TEMPO:</label>
                        <div class="timer-jogo">
                            <div class="controles-jogo">
                                <div class="btn-controll play">
                                    <img width="25px" src="play.png" alt="Play">
                                </div>
                                <div class="btn-controll pause">
                                    <img width="25px" src="pause.png" alt="Pause">
                                </div>
                                <div class="btn-controll stop">
                                    <img width="25px" src="stop.png" alt="Stop">
                                </div>
                            </div>
                            <div class="cronometro">
                                <span class="tempo-restante">7:00</span>
                            </div>
                        </div>
                    </div>

                </div>

                <div class="topo-times">
                    <div class="topo-time-1">
                        <label class="label-app" style="text-align: center;">TIME 1</label>
                        <div class="gols-time-1">
                            <div class="add" id="add-gol-1">+</div>
                            <span class="gols-1">0</span>
                            <div class="remove" id="remove-gol-1">-</div>
                        </div>
                        <div class="lista-jogadores-time-1">
                            <!-- <div class="jogador-time-1"></div> -->
                        </div>
                    </div>
                    <span class="versus">X</span>
                    <div class="topo-time-2">
                        <label class="label-app" style="text-align: center;">TIME 2</label>
                        <div class="gols-time-2">
                            <div class="add" id="add-gol-2">+</div>
                            <span class="gols-2">0</span>
                            <div class="remove" id="remove-gol-2">-</div>
                        </div>
                        <div class="lista-jogadores-time-2">
                            
                        </div>
                    </div>
                </div>

                <button onclick="proximaPartida()" class="btn-app ">
                    PRÃ“XIMA PARTIDA
                </button>

                <hr>
                
                <label class="label-app">| Proximo time</label>
                <div class="proximo-time-area">
                    <div class="proximo-time">
                        <!-- <div class="proximo-time-jogador"></div> -->
                    </div>
                </div>

                <!-- <button onclick="visaoJogo()" class="btn-app ">
                    VISAO DE JOGO
                </button> -->

           </div>
        </div>
    </div>

    <script>
        window.onload = function() {
            addJogadoresTime1ToHTML();
            addJogadoresTime2ToHTML();
            definirProxReservas();
            controladorPontos();
            handlerStatusGame();
            // handlerTimerGame();
        }

        function addJogadoresTime1ToHTML() {
            // pega os jogadores armazenados no LocalStorage
            const time1Storage = JSON.parse(localStorage.getItem("time1"));

            // pega o elemento HTML do time 1
            const time1 = document.querySelector(".lista-jogadores-time-1");

            // percorre os jogadores do time 1 e adiciona-os no HTML
            for (let i = 0; i < time1Storage.length; i++) {
                const jogador = time1Storage[i];
                const jogadorTime1 = document.createElement("div");
                jogadorTime1.classList.add("jogador-time-1");
                jogadorTime1.innerText = jogador.nome;
                jogadorTime1.setAttribute("data-id", jogador.id);
                time1.appendChild(jogadorTime1);
            }
        }

        function addJogadoresTime2ToHTML() {
            // pega os jogadores armazenados no LocalStorage
            const time2Storage = JSON.parse(localStorage.getItem("time2"));

            // pega o elemento HTML do time 2
            const time2 = document.querySelector(".lista-jogadores-time-2");

            // percorre os jogadores do time 2 e adiciona-os no HTML
            for (let i = 0; i < time2Storage.length; i++) {
                const jogador = time2Storage[i];
                const jogadorTime2 = document.createElement("div");
                jogadorTime2.classList.add("jogador-time-2");
                jogadorTime2.innerText = jogador.nome;
                jogadorTime2.setAttribute("data-id", jogador.id);
                time2.appendChild(jogadorTime2);
            }
        }

        function definirProxReservas() {
            const jogadores = JSON.parse(localStorage.getItem("jogadores"));
            const time1 = JSON.parse(localStorage.getItem("time1"));
            const time2 = JSON.parse(localStorage.getItem("time2"));

            const jogadoresTime1Ids = time1.map(jogador => jogador.id);
            const jogadoresTime2Ids = time2.map(jogador => jogador.id);

            const proxReservas = jogadores.filter(jogador => !jogadoresTime1Ids.includes(jogador.id) && !jogadoresTime2Ids.includes(jogador.id));
            const containerProxReservas = document.querySelector(".proximo-time");

            for (let i = 0; i < proxReservas.length; i++) {
                const jogador = proxReservas[i];
                const jogadorProxReserva = document.createElement("div");
                jogadorProxReserva.classList.add("proximo-time-jogador");
                jogadorProxReserva.innerText = jogador.nome;
                jogadorProxReserva.setAttribute("data-id", jogador.id);
                containerProxReservas.appendChild(jogadorProxReserva);
            }

            localStorage.setItem("proxReservas", JSON.stringify(proxReservas));
        }

        function controladorPontos() {
            const addGolBtn1 = document.querySelector("#add-gol-1");
            const removeGolBtn1 = document.querySelector("#remove-gol-1");
            const golsSpan1 = document.querySelector(".gols-1");

            addGolBtn1.addEventListener("click", function() {
                let gols = parseInt(golsSpan1.innerText);
                gols++;
                golsSpan1.innerText = gols;
            });

            removeGolBtn1.addEventListener("click", function() {
                let gols = parseInt(golsSpan1.innerText);
                if (gols > 0) {
                    gols--;
                    golsSpan1.innerText = gols;
                }
            });

            const addGolBtn2 = document.querySelector("#add-gol-2");
            const removeGolBtn2 = document.querySelector("#remove-gol-2");
            const golsSpan2 = document.querySelector(".gols-2");

            addGolBtn2.addEventListener("click", function() {
                let gols = parseInt(golsSpan2.innerText);
                gols++;
                golsSpan2.innerText = gols;
            });

            removeGolBtn2.addEventListener("click", function() {
                let gols = parseInt(golsSpan2.innerText);
                if (gols > 0) {
                    gols--;
                    golsSpan2.innerText = gols;
                }
            });
        }

        function handlerStatusGame() {
            const playBtn = document.querySelector(".play img");
            const pauseBtn = document.querySelector(".pause img");
            const stopBtn = document.querySelector(".stop img");
            const sinal = document.querySelector(".sinal");

            playBtn.addEventListener("click", playGame);
            pauseBtn.addEventListener("click", pauseGame);
            stopBtn.addEventListener("click", stopGame);

            function playGame() {
                sinal.classList.remove("parado");
                iniciarCronometro();
                sinal.classList.remove("fim-de-jogo");
                sinal.classList.add("em-andamento");
                sinal.innerText = "Em andamento";
            }

            function pauseGame() {
                sinal.classList.remove("em-andamento");
                sinal.classList.remove("fim-de-jogo");
                sinal.classList.add("parado");
                sinal.innerText = "Pausado";
            }

            function stopGame() {
                sinal.classList.remove("em-andamento");
                sinal.classList.remove("parado");
                sinal.classList.add("fim-de-jogo");
                sinal.innerText = "Fim de jogo";
            }

            let intervalId;
            let tempoRestante = 7 * 60;

            function iniciarCronometro() {
                intervalId = setInterval(atualizarCronometro, 1000);
            }
            
            function atualizarCronometro() {
                tempoRestante--;
                const minutos = Math.floor(tempoRestante / 60);
                const segundos = tempoRestante % 60;
                document.querySelector(".tempo-restante").innerText = `${minutos}:${segundos < 10 ? "0" + segundos : segundos}`;
                if (tempoRestante === 0) {
                    pararCronometro();
                    alert("Fim de jogo!");
                }
            }
            
            function pararCronometro() {
                clearInterval(intervalId);
            }

        }

    </script>
</body>
</html>